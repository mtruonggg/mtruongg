<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Countdown</title>

<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#071b2a;
  font-family:system-ui;
  color:#ffe66d;
}

.wrap{text-align:center;width:100%}

.countdown{
  display:flex;
  gap:16px;
  justify-content:center;
}

.unit{display:flex;flex-direction:column;align-items:center}
.unit.hide{display:none}

.box{
  width:78px;
  height:64px;
  background:#fff;
  color:#111;
  border-radius:12px;
  font-size:34px;
  font-weight:700;
  position:relative;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* Box nh√∫n nh·∫π */
.box.animate{
  animation: boxJump 0.3s ease;
}

@keyframes boxJump{
  0%{ transform: translateY(0); }
  30%{ transform: translateY(8%); }
  60%{ transform: translateY(0); }
  100%{ transform: translateY(0); }
}

.num{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
}

.num.current{transform:translateY(0);opacity:1}
.num.next{transform:translateY(-100%);opacity:0}

.box.slide .num.current{
  transform:translateY(100%);
  opacity:0;
  transition:.32s ease;
}

.box.slide .num.next{
  transform:translateY(0);
  opacity:1;
  transition:.32s ease;
}

.label{margin-top:6px;font-size:12px;color:#fff}
.info{margin-top:18px;font-size:14px;color:#fff}
</style>
</head>

<body>
<div class="wrap">
  <h1>COUNTDOWN XU√ÇN B√çNH NG·ªå 2026</h1>

  <div class="countdown">
    <div class="unit" id="ud"><div class="box" id="d"></div><div class="label">NG√ÄY</div></div>
    <div class="unit" id="uh"><div class="box" id="h"></div><div class="label">GI·ªú</div></div>
    <div class="unit" id="um"><div class="box" id="m"></div><div class="label">PH√öT</div></div>
    <div class="unit" id="us"><div class="box" id="s"></div><div class="label">GI√ÇY</div></div>
  </div>

  <div class="info" id="info">Ch·∫°m m√†n h√¨nh ƒë·ªÉ b·∫≠t √¢m thanh</div>
</div>

<script>
/* ===== CONFIG ===== */
const TARGET = new Date(2026,0,31,19,40,0).getTime(); // 17/02/2026
const TICK1  = "https://files.catbox.moe/o0fdwn.mp3";
const TICK2  = "https://files.catbox.moe/o0fdwn.mp3";
const REDIRECT_URL = "./fireworks.html";
/* ================= */

let lastRemain = null;
let soundOK = false;
let tickToggle = false;
let redirected = false;

/* ===== AUDIO ===== */
const tick1Audio = new Audio(TICK1);
const tick2Audio = new Audio(TICK2);
tick1Audio.volume = 0.9;
tick2Audio.volume = 0.9;

// b·∫≠t √¢m thanh khi ch·∫°m
window.addEventListener("pointerdown",()=>{
  if(soundOK) return;
  soundOK = true;
  tick1Audio.play().then(()=>tick1Audio.pause());
  tick2Audio.play().then(()=>tick2Audio.pause());
  info.textContent="√Çm thanh ƒë√£ b·∫≠t";
},{once:true});

// tick xen k·∫Ω
function playTick(){
  if(!soundOK) return;
  tickToggle = !tickToggle;
  if(tickToggle){
    tick1Audio.currentTime=0;
    tick1Audio.play().catch(()=>{});
  }else{
    setTimeout(()=>{
      tick2Audio.currentTime=0;
      tick2Audio.play().catch(()=>{});
    },400);
  }
}

/* ===== INIT BOX ===== */
function init(id){
  const el=document.getElementById(id);
  const n=document.createElement("div");
  n.className="num current";
  n.textContent="00";
  el.appendChild(n);
}
["d","h","m","s"].forEach(init);

/* ===== UPDATE NUMBER ===== */
function update(el,val){
  const cur=el.querySelector(".current");
  if(cur && cur.textContent===val) return;

  const next=document.createElement("div");
  next.className="num next";
  next.textContent=val;
  el.appendChild(next);

  const box = el.closest(".box") || el;
  box.classList.add("animate");
  requestAnimationFrame(()=>el.classList.add("slide"));

  setTimeout(()=>{
    el.innerHTML="";
    const n=document.createElement("div");
    n.className="num current";
    n.textContent=val;
    el.appendChild(n);
    el.classList.remove("slide");
    box.classList.remove("animate");
  },350);
}

const dEl=d, hEl=h, mEl=m, sEl=s;
const ud=document.getElementById("ud");
const uh=document.getElementById("uh");
const um=document.getElementById("um");

/* ===== LOOP ===== */
function loop(){
  const now = Date.now();
  const remain = Math.max(0, Math.floor((TARGET-now)/1000));

  // üéÜ H·∫æT GI·ªú ‚Üí CHUY·ªÇN FIREWORKS
  if(remain === 0 && !redirected){
    redirected = true;

    tick1Audio.pause();
    tick2Audio.pause();

    setTimeout(()=>{
      window.location.href = REDIRECT_URL;
    },500);

    return;
  }

  if(remain !== lastRemain){
    lastRemain = remain;

    const d = Math.floor(remain/86400);
    const h = Math.floor(remain%86400/3600);
    const m = Math.floor(remain%3600/60);
    const s = remain%60;

    update(dEl,String(d).padStart(2,"0"));
    update(hEl,String(h).padStart(2,"0"));
    update(mEl,String(m).padStart(2,"0"));
    update(sEl,String(s).padStart(2,"0"));

    if(d<=0) ud.classList.add("hide");
    if(d<=0&&h<=0) uh.classList.add("hide");
    if(d<=0&&h<=0&&m<=0) um.classList.add("hide");

    playTick();
  }

  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
